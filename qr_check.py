import pprint
import numpy

numpy.set_printoptions(precision=4, linewidth=300)

M = [
    [3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8,3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8],
    [2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5,2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5],
    [-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4,-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4],
    [-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9,-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9],
    [-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11,-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11],
    [4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2,4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2],
    [3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8,3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8],
    [2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5,2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5],
    [-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4,-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4],
    [-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9,-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9],
    [-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11,-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11],
    [4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2,4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2],
    [3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8,3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8],
    [2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5,2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5],
    [-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4,-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4],
    [-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9,-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9],
    [-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11,-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11],
    [4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2,4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2],
    [3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8,3, 2, -1, 4, -7, 8, 3, 2, -1, 4, -7, 8],
    [2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5,2, 1, 9, 7, -1, 5, 2, 1, 9, 7, -1, 5],
    [-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4,-7, 5, 2, -6, 3, 4, -7, 5, 2, -6, 3, 4],
    [-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9,-1, 2, 1, -4, 6, -9, -1, 2, 1, -4, 6, -9],
    [-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11,-9, 16, 3, 1, 4, 11, -9, 16, 3, 1, 4, 11],
    [4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2,4, -2, 3, 7, 2, 2, 4, -2, 3, 7, 2, 2]
]

R_Vitis = numpy.loadtxt("R_matrix.txt", dtype=float)
print('\nR_Vitis:\n',R_Vitis)

A = numpy.array(numpy.around(M, decimals=10))  
Q, R = numpy.linalg.qr(A)

Q = numpy.array(numpy.around(Q, decimals=10))
R = numpy.array(numpy.around(R, decimals=10))

print('\nA:\n', A)
print('\nQ:\n', Q)
print('\nR:\n', R)

A_Vitis = numpy.around((numpy.dot(Q, R_Vitis)), decimals = 10)
print('\nA_Vitis:\n', A_Vitis)
